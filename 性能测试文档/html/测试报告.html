<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仓储管理系统性能测试报告</title>
    <!-- 引入Bootstrap美化样式 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入Chart.js实现数据可视化 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <style>
        .report-header { text-align: center; margin: 20px 0; }
        .section { margin: 30px 0; padding: 20px; border: 1px solid #eee; border-radius: 8px; }
        .section-title { border-left: 4px solid #0d6efd; padding-left: 10px; margin-bottom: 20px; }
        .table-responsive { margin: 15px 0; }
        .chart-container { height: 400px; margin: 20px 0; }
    </style>
</head>
<body class="container">
    <!-- 报告头部 -->
    <div class="report-header">
        <h1 class="text-primary">仓储管理系统性能测试报告</h1>
        <p class="text-muted">测试周期：2024-09-01 至 2024-09-08 | 测试工具：JMeter 5.6、Grafana 10.2</p>
    </div>

    <!-- 1. 报告概述 -->
    <div class="section">
        <h2 class="section-title">1. 报告概述</h2>
        <div class="row">
            <div class="col-md-6">
                <h5 class="fw-bold">1.1 测试目的</h5>
                <p>验证仓储管理系统在不同负载场景下的性能表现，确认是否满足业务预期指标，识别性能瓶颈（如响应时间过长、服务器资源不足等），为系统优化提供依据。</p>
            </div>
            <div class="col-md-6">
                <h5 class="fw-bold">1.2 测试范围</h5>
                <p>覆盖系统核心业务模块：<br>
                - 高频操作模块：首页、进货管理、出货管理、储位管理<br>
                - 数据密集模块：客户报表、业务报表、盘点管理<br>
                - 实时交互模块：AGV调度、预警管理、运输管理</p>
            </div>
        </div>
    </div>

    <!-- 2. 测试环境 -->
    <div class="section">
        <h2 class="section-title">2. 测试环境</h2>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>环境类型</th>
                        <th>配置项</th>
                        <th>具体参数</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td rowspan="3">服务器环境</td>
                        <td>应用服务器</td>
                        <td>CPU：Intel Xeon 8375C（8核16线程）、内存：32GB、硬盘：1TB SSD、操作系统：CentOS 8</td>
                    </tr>
                    <tr>
                        <td>数据库服务器</td>
                        <td>CPU：Intel Xeon 8375C（16核32线程）、内存：64GB、硬盘：2TB SSD、数据库：MySQL 8.0（主从架构）</td>
                    </tr>
                    <tr>
                        <td>缓存服务器</td>
                        <td>Redis 6.2（集群模式，3主3从）、内存：16GB/节点</td>
                    </tr>
                    <tr>
                        <td>客户端环境</td>
                        <td>测试机配置</td>
                        <td>CPU：Intel i7-12700H、内存：16GB、操作系统：Windows 11、JMeter 5.6（分布式部署，5台从机）</td>
                    </tr>
                    <tr>
                        <td>网络环境</td>
                        <td>带宽与延迟</td>
                        <td>服务器内网带宽：10Gbps、客户端到服务器网络延迟：≤5ms、丢包率：0%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 3. 测试策略与指标基准 -->
    <div class="section">
        <h2 class="section-title">3. 测试策略与指标基准</h2>
        <h5 class="fw-bold">3.1 测试场景设计</h5>
        <div class="table-responsive mb-4">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>场景类型</th>
                        <th>场景描述</th>
                        <th>测试参数</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>并发用户场景</td>
                        <td>模拟多用户同时执行核心操作（如进货单创建、出货拣货）</td>
                        <td>并发用户数：50/100/150/200/250；持续时间：10分钟/场景</td>
                    </tr>
                    <tr>
                        <td>大数据量场景</td>
                        <td>模拟系统存储海量数据后（如10万条进货记录、5万条储位数据）的操作性能</td>
                        <td>数据量：基础数据100万条；操作：报表生成、库存查询；持续时间：5分钟</td>
                    </tr>
                    <tr>
                        <td>长时间稳定性场景</td>
                        <td>模拟业务高峰期持续运行（如上午9:00-12:00的进货验收高峰）</td>
                        <td>并发用户数：150；持续时间：3小时；操作频率：每用户30秒/次请求</td>
                    </tr>
                    <tr>
                        <td>峰值冲击场景</td>
                        <td>模拟突发高并发（如促销活动导致的集中出货请求）</td>
                        <td>用户数：从50突增至300（5秒内）；持续时间：2分钟；操作：出货单提交</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h5 class="fw-bold">3.2 性能指标基准</h5>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>指标类型</th>
                        <th>指标名称</th>
                        <th>基准要求（达标值）</th>
                        <th>严重阈值（不达标）</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td rowspan="3">应用性能</td>
                        <td>平均响应时间</td>
                        <td>≤1.5秒（核心接口）、≤3秒（非核心接口）</td>
                        <td>核心接口>2秒、非核心接口>4秒</td>
                    </tr>
                    <tr>
                        <td>吞吐量（TPS）</td>
                        <td>核心接口≥50 TPS、非核心接口≥20 TPS</td>
                        <td>核心接口<30 TPS、非核心接口<10 TPS</td>
                    </tr>
                    <tr>
                        <td>错误率</td>
                        <td>≤0.1%</td>
                        <td>>0.5%</td>
                    </tr>
                    <tr>
                        <td rowspan="3">服务器资源</td>
                        <td>CPU使用率</td>
                        <td>应用服务器≤70%、数据库服务器≤80%</td>
                        <td>应用服务器>85%、数据库服务器>95%</td>
                    </tr>
                    <tr>
                        <td>内存使用率</td>
                        <td>应用服务器≤80%、数据库服务器≤85%</td>
                        <td>应用服务器>90%、数据库服务器>95%</td>
                    </tr>
                    <tr>
                        <td>磁盘IO</td>
                        <td>读写延迟≤10ms、磁盘使用率≤80%</td>
                        <td>读写延迟>20ms、磁盘使用率>90%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 4. 测试结果详情 -->
    <div class="section">
        <h2 class="section-title">4. 测试结果详情</h2>

        <!-- 4.1 并发用户场景结果 -->
        <h5 class="fw-bold mb-3">4.1 并发用户场景结果</h5>
        <div class="table-responsive mb-4">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>并发用户数</th>
                        <th>平均响应时间（秒）</th>
                        <th>吞吐量（TPS）</th>
                        <th>错误率</th>
                        <th>应用服务器CPU使用率</th>
                        <th>数据库CPU使用率</th>
                        <th>是否达标</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>50</td>
                        <td>0.8</td>
                        <td>62</td>
                        <td>0%</td>
                        <td>35%</td>
                        <td>42%</td>
                        <td class="text-success">是</td>
                    </tr>
                    <tr>
                        <td>100</td>
                        <td>1.2</td>
                        <td>78</td>
                        <td>0%</td>
                        <td>52%</td>
                        <td>58%</td>
                        <td class="text-success">是</td>
                    </tr>
                    <tr>
                        <td>150</td>
                        <td>1.6</td>
                        <td>85</td>
                        <td>0.05%</td>
                        <td>68%</td>
                        <td>72%</td>
                        <td class="text-success">是（核心接口接近阈值）</td>
                    </tr>
                    <tr>
                        <td>200</td>
                        <td>2.3</td>
                        <td>76</td>
                        <td>0.2%</td>
                        <td>82%</td>
                        <td>88%</td>
                        <td class="text-warning">部分达标（核心接口响应时间超阈值）</td>
                    </tr>
                    <tr>
                        <td>250</td>
                        <td>3.8</td>
                        <td>52</td>
                        <td>0.8%</td>
                        <td>92%</td>
                        <td>96%</td>
                        <td class="text-danger">否（多项指标超严重阈值）</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- 并发场景响应时间趋势图 -->
        <div class="chart-container">
            <canvas id="concurrencyRtChart"></canvas>
        </div>

        <!-- 4.2 大数据量场景结果 -->
        <h5 class="fw-bold mb-3 mt-6">4.2 大数据量场景结果</h5>
        <div class="table-responsive mb-4">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>测试模块</th>
                        <th>数据量</th>
                        <th>操作类型</th>
                        <th>平均响应时间（秒）</th>
                        <th>错误率</th>
                        <th>是否达标</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>客户报表</td>
                        <td>10万条客户订单数据</td>
                        <td>月度报表生成（Excel导出）</td>
                        <td>2.8</td>
                        <td>0%</td>
                        <td class="text-success">是</td>
                    </tr>
                    <tr>
                        <td>盘点管理</td>
                        <td>5万条储位库存数据</td>
                        <td>全库盘点结果提交</td>
                        <td>2.2</td>
                        <td>0%</td>
                        <td class="text-success">是</td>
                    </tr>
                    <tr>
                        <td>业务报表</td>
                        <td>100万条基础物料数据</td>
                        <td>年度进货趋势分析（图表渲染）</td>
                        <td>3.5</td>
                        <td>0.1%</td>
                        <td class="text-warning">部分达标（响应时间超非核心接口阈值）</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 4.3 长时间稳定性场景结果 -->
        <h5 class="fw-bold mb-3 mt-6">4.3 长时间稳定性场景结果</h5>
        <div class="row">
            <div class="col-md-6">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead class="table-primary">
                            <tr>
                                <th>监控指标</th>
                                <th>平均值</th>
                                <th>峰值</th>
                                <th>是否达标</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>平均响应时间（秒）</td>
                                <td>1.5</td>
                                <td>2.1</td>
                                <td class="text-success">是</td>
                            </tr>
                            <tr>
                                <td>吞吐量（TPS）</td>
                                <td>72</td>
                                <td>85</td>
                                <td class="text-success">是</td>
                            </tr>
                            <tr>
                                <td>错误率</td>
                                <td>0.03%</td>
                                <td>0.1%</td>
                                <td class="text-success">是</td>
                            </tr>
                            <tr>
                                <td>应用服务器CPU使用率</td>
                                <td>65%</td>
                                <td>78%</td>
                                <td class="text-success">是</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-6">
                <!-- 稳定性场景CPU使用率趋势图 -->
                <div class="chart-container">
                    <canvas id="stabilityCpuChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 4.4 峰值冲击场景结果 -->
        <h5 class="fw-bold mb-3 mt-6">4.4 峰值冲击场景结果</h5>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>冲击参数</th>
                        <th>平均响应时间（秒）</th>
                        <th>吞吐量（TPS）</th>
                        <th>错误率</th>
                        <th>服务器状态</th>
                        <th>是否达标</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>5秒内用户从50→300</td>
                        <td>4.2</td>
                        <td>48</td>
                        <td>1.2%</td>
                        <td>应用服务器CPU达95%，出现短暂请求排队</td>
                        <td class="text-danger">否（响应时间、错误率均超严重阈值）</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 5. 性能瓶颈分析 -->
    <div class="section">
        <h2 class="section-title">5. 性能瓶颈分析</h2>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>瓶颈现象</th>
                        <th>涉及场景/模块</th>
                        <th>根因分析</th>
                        <th>验证方式</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>并发200+用户时，核心接口响应时间超2秒</td>
                        <td>并发用户场景（进货管理、出货管理）</td>
                        <td>1. 进货单创建接口未优化数据库索引，导致插入数据时锁表时间过长；<br>2. 出货拣货接口未充分利用Redis缓存，频繁查询数据库库存</td>
                        <td>1. 数据库慢查询日志：发现进货单表insert语句耗时>500ms；<br>2. Redis监控：出货拣货接口缓存命中率仅40%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 6. 优化建议 -->
    <div class="section">
        <h2 class="section-title">6. 优化建议</h2>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-primary">
                    <tr>
                        <th>优化方向</th>
                        <th>具体措施</th>
                        <th>预期效果</th>
                        <th>优先级</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>数据库优化</td>
                        <td>1. 为进货单表（purchase_order）的order_no、create_time字段添加联合索引；<br>2. 对盘点结果表（stocktake_result）进行分表（按月份分表）</td>
                        <td>1. 进货单创建接口响应时间减少30%；<br>2. 全库盘点提交响应时间减少25%</td>
                        <td>高</td>
                    </tr>
                    <tr>
                        <td>缓存优化</td>
                        <td>1. 扩大出货拣货接口缓存范围（缓存储位库存、货品规格），设置缓存过期时间30分钟；<br>2. 为业务报表模块添加Redis预热机制（凌晨预生成高频报表数据）</td>
                        <td>1. 出货拣货接口缓存命中率提升至90%+；<br>2. 业务报表生成响应时间减少40%</td>
                        <td>高</td>
                    </tr>
                    <tr>
                        <td>服务器资源扩容</td>
                        <td>1. 应用服务器内存从32GB扩容至64GB；<br>2. 为数据库服务器添加读写分离中间件（MyCat），分担读请求压力</td>
                        <td>1. 高并发下应用服务器内存使用率降低20%；<br>2. 数据库读请求响应时间减少35%</td>
                        <td>中</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 7. 测试结论 -->
    <div class="section">
        <h2 class="section-title">7. 测试结论</h2>
        <div class="row">
            <div class="col-md-12">
                <p class="mb-2"><strong>7.1 整体结论</strong>：仓储管理系统在<strong>150并发用户以内、常规数据量（≤5万条）、3小时稳定性运行</strong>场景下，性能指标均满足业务基准要求；但在<strong>高并发（200+用户）、大数据量报表生成（100万条+）、峰值冲击（300用户突发）</strong>场景下，存在响应时间过长、服务器资源不足等问题，需通过优化后重新验证。</p>
                <p class="mb-2"><strong>7.2 达标模块</strong>：首页、储位管理、AGV调度、预警管理、人员配置（核心操作在全场景下达标）。</p>
                <p class="mb-2"><strong>7.3 待优化模块</strong>：进货管理（高并发插入）、业务报表（大数据量渲染）、出货管理（峰值冲击下排队）。</p>
                <p><strong>7.4 后续建议</strong>：1. 优先落地“数据库索引优化”“缓存范围扩大”措施，完成后执行回归性能测试；2. 新增“促销高峰期峰值测试”场景，验证优化后系统抗冲击能力；3. 建立性能监控常态化机制（Grafana+Prometheus），实时跟踪线上系统性能指标。</p>
            </div>
        </div>
    </div>

    <!-- 8. 附录 -->
    <div class="section">
        <h2 class="section-title">8. 附录</h2>
        <ul class="list-group list-group-flush">
            <li class="list-group-item"><strong>附录1：测试脚本</strong>：JMeter脚本存放路径（服务器路径：/opt/jmeter/scripts/warehouse_perf/）</li>
            <li class="list-group-item"><strong>附录2：监控数据</strong>：Grafana监控面板链接（http://grafana.warehouse-system.com/d/123/perf-monitor）</li>
            <li class="list-group-item"><strong>附录3：测试团队</strong>：测试负责人（张三）、测试工程师（李四、王五）</li>
        </ul>
    </div>

    <!-- 图表初始化脚本 -->
    <script>
        // 4.1 并发场景响应时间趋势图
        const concurrencyRtCtx = document.getElementById('concurrencyRtChart').getContext('2d');
        new Chart(concurrencyRtCtx, {
            type: 'line',
            data: {
                labels: ['50并发', '100并发', '150并发', '200并发', '250并发'],
                datasets: [{
                    label: '平均响应时间（秒）',
                    data: [0.8, 1.2, 1.6, 2.3, 3.8],
                    borderColor: '#0d6efd',
                    backgroundColor: 'rgba(13, 110, 253, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }, {
                    label: '核心接口阈值（秒）',
                    data: [2, 2, 2, 2, 2],
                    borderColor: '#ffc107',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    fill: false,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: '响应时间（秒）' }
                    },
                    x: { title: { display: true, text: '并发用户数' } }
                },
                plugins: {
                    title: { display: true, text: '并发用户场景响应时间趋势', font: { size: 16 } },
                    legend: { position: 'bottom' }
                }
            }
        });

        // 4.3 稳定性场景CPU使用率趋势图
        const stabilityCpuCtx = document.getElementById('stabilityCpuChart').getContext('2d');
        new Chart(stabilityCpuCtx, {
            type: 'line',
            data: {
                labels: ['0h', '0.5h', '1h', '1.5h', '2h', '2.5h', '3h'],
                datasets: [{
                    label: '应用服务器CPU使用率（%）',
                    data: [45, 58, 65, 68, 66, 72, 78],
                    borderColor: '#28a745',
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }, {
                    label: '数据库服务器CPU使用率（%）',
                    data: [50, 62, 70, 75, 72, 80, 85],
                    borderColor: '#dc3545',
                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        title: { display: true, text: 'CPU使用率（%）' }
                    },
                    x: { title: { display: true, text: '运行时间' } }
                },
                plugins: {
                    title: { display: true, text: '3小时稳定性场景CPU使用率趋势', font: { size: 16 } },
                    legend: { position: 'bottom' }
                }
            }
        });
    </script>
</body>
</html>